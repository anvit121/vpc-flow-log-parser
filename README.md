# Amazon VPC Flow Log Parser

This is a Python script to parse Amazon VPC flow logs, and it assigns tags to each flow based on the lookup table by using the combination of 'dstport' and 'protocol' which is extracted from the flow log file.

## Structure of the Project

```bash
├── log_parser.py           # Main script for parsing the VPC flow logs
├── lookup_table.csv        # Sample lookup table
├── sample_flow_logs.txt    # Sample flow log file    
├── testing/                # Folder containing test files
│   ├── test_flow_logs.txt       # Sample flow log file for testing
│   ├── test_lookup_table.csv    # Sample lookup table for testing
│   ├── testing_log_parser.py    # Script to validate the script's functionality
│   └── test_output.txt          # Output file generated by testing_log_parser.py
├── output.txt              # Output file generated by log_parser.py
└── README.md               # Documentation for the project
```

## Usage

1. Clone the Repository
```bash
git clone https://github.com/anvit121/vpc-flow-log-parser.git
```
2. To run the python script with default flow logs 
```bash
python log_parser.py
```
3. To run the python script with custom flow logs 
```bash
cd testing
python testing_log_parser.py
```

## Testing

### The testing folder contains:

1. ``test_lookup_table.csv`` - A sample lookup table with some missing tags to test the error handling of the script.
2. ``test_flow_logs.txt`` - A sample flow log file that contains valid records, some unsupported protocols, and incomplete lines of logs, which may simulate real-world scenarios.
3. ``testing_log_parser.py`` - A python script that is used for testing the script with these sample files.

### Conclusion:
1. It checks that the tags are correctly assigned to the matching entries.
2. It makes sure that the flow logs are handled properly when tags are not present in the lookup file.
3. It also validates that each of the destination port and protocol combinations are accurate.

## Assumptions

1. Supported protocols are ``ICMP(1)``, ``TCP(6)``, and ``UDP(17)``.
2. Missing lines in either input file are ignored during parsing to ensure that the script is robust and continues to work even if there are is incomplete or missing data.
3. File paths for the flow logs and lookup table are hardcoded in the script, so no dynamic user input can be provided.
4. In case of duplicate entries, the entry that occured last will be used.

### References
https://docs.aws.amazon.com/vpc/latest/userguide/flow-log-records.html \
https://docs.aws.amazon.com/vpc/latest/userguide/flow-logs-basics.html 